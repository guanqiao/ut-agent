## 重构计划概览

已创建详细的重构计划文档：[UT-Agent架构重构计划(TDD方式).md](file:///f:/dev/opensource/ut-agent/.trae/documents/UT-Agent架构重构计划(TDD方式).md)

### 阶段一：高优先级 (P0)
1. **Agent 与 Graph 模块整合** - 让 Graph 节点调用 Agent 执行任务，统一架构
2. **LLM 异步调用优化** - 全面异步化 + 重试机制 + 速率限制

### 阶段二：中优先级 (P1)
3. **并行处理策略优化** - 使用 asyncio.gather 替代线程池
4. **错误处理增强** - 全局异常处理器 + 恢复策略
5. **Prompt 模板外部化** - 模板文件化 + 热更新

### 阶段三：低优先级 (P2)
6. **配置管理重构** - Pydantic 嵌套模型 + 热重载
7. **依赖注入容器** - 移除全局单例 + 支持 Mock
8. **性能监控增强** - OpenTelemetry 集成 + 瓶颈识别

### 开发方式
- **TDD**：先写测试，再写实现
- **增量重构**：每个模块独立重构，确保测试通过
- **向后兼容**：保持 API 接口稳定

### 时间线
- Week 1-2: 阶段一
- Week 3-5: 阶段二  
- Week 6-8: 阶段三

确认后将开始按 TDD 方式执行重构。